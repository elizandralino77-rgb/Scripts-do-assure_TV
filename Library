--// Carrega a Library
local Library = {}

--// Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local plr = Players.LocalPlayer

--// Main Window
function Library:CreateWindow(title, toggleKey)
    local Window = {}
    
    -- ScreenGui
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = title:gsub(" ", "")
    screenGui.ResetOnSpawn = false
    screenGui.Parent = game.CoreGui
    
    -- Main Frame
    local mainFrame = Instance.new("Frame")
    mainFrame.Size = UDim2.new(0, 500, 0, 400)
    mainFrame.Position = UDim2.new(0.5, -250, 0.5, -200)
    mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    mainFrame.BorderSizePixel = 0
    mainFrame.Visible = true
    mainFrame.Parent = screenGui
    
    -- Title
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(1, 0, 0, 30)
    titleLabel.Position = UDim2.new(0, 0, 0, 0)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = title
    titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextSize = 18
    titleLabel.Parent = mainFrame
    
    -- Tabs container
    local tabsFrame = Instance.new("Frame")
    tabsFrame.Size = UDim2.new(1, 0, 1, -30)
    tabsFrame.Position = UDim2.new(0, 0, 0, 30)
    tabsFrame.BackgroundTransparency = 1
    tabsFrame.Parent = mainFrame
    
    Window.Tabs = {}
    
    function Window:AddTab(tabName)
        local Tab = {}
        
        local tabFrame = Instance.new("Frame")
        tabFrame.Size = UDim2.new(1, 0, 1, 0)
        tabFrame.BackgroundTransparency = 1
        tabFrame.Visible = true
        tabFrame.Parent = tabsFrame
        
        Tab.Sections = {}
        
        function Tab:AddSection(sectionName)
            local Section = {}
            local sectionFrame = Instance.new("Frame")
            sectionFrame.Size = UDim2.new(1, -20, 0, 200)
            sectionFrame.Position = UDim2.new(0, 10, 0, (#Tab.Sections)*210)
            sectionFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
            sectionFrame.BorderSizePixel = 0
            sectionFrame.Parent = tabFrame
            
            -- Section title
            local sectionLabel = Instance.new("TextLabel")
            sectionLabel.Size = UDim2.new(1, -10, 0, 25)
            sectionLabel.Position = UDim2.new(0, 5, 0, 5)
            sectionLabel.BackgroundTransparency = 1
            sectionLabel.Text = sectionName
            sectionLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
            sectionLabel.Font = Enum.Font.GothamBold
            sectionLabel.TextSize = 14
            sectionLabel.TextXAlignment = Enum.TextXAlignment.Left
            sectionLabel.Parent = sectionFrame
            
            Section.Sliders = {}
            
            function Section:AddSlider(name, min, max, default, step, callback)
                local Slider = {}
                Slider.Value = default
                
                local sliderFrame = Instance.new("Frame")
                sliderFrame.Size = UDim2.new(1, -10, 0, 40)
                sliderFrame.Position = UDim2.new(0, 5, 0, 35 + (#Section.Sliders)*45)
                sliderFrame.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
                sliderFrame.BorderSizePixel = 0
                sliderFrame.Parent = sectionFrame
                
                local sliderLabel = Instance.new("TextLabel")
                sliderLabel.Size = UDim2.new(0, 150, 1, 0)
                sliderLabel.Position = UDim2.new(0, 5, 0, 0)
                sliderLabel.BackgroundTransparency = 1
                sliderLabel.Text = name.." : "..default
                sliderLabel.TextColor3 = Color3.fromRGB(255,255,255)
                sliderLabel.Font = Enum.Font.Gotham
                sliderLabel.TextSize = 14
                sliderLabel.TextXAlignment = Enum.TextXAlignment.Left
                sliderLabel.Parent = sliderFrame
                
                local sliderBar = Instance.new("TextButton")
                sliderBar.Size = UDim2.new(1, -160, 0, 20)
                sliderBar.Position = UDim2.new(0, 155, 0, 10)
                sliderBar.Text = ""
                sliderBar.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
                sliderBar.Parent = sliderFrame
                
                -- Drag
                local mouse = plr:GetMouse()
                local dragging = false
                
                sliderBar.MouseButton1Down:Connect(function()
                    dragging = true
                end)
                
                mouse.Move:Connect(function()
                    if dragging then
                        local relativeX = math.clamp(mouse.X - sliderBar.AbsolutePosition.X,0,sliderBar.AbsoluteSize.X)
                        local percent = relativeX / sliderBar.AbsoluteSize.X
                        local value = math.floor(min + (max - min)*percent)
                        Slider.Value = value
                        sliderLabel.Text = name.." : "..value
                        if callback then callback(value) end
                    end
                end)
                
                mouse.Button1Up:Connect(function()
                    dragging = false
                end)
                
                Section.Sliders[name] = Slider
                return Slider
            end
            
            Tab.Sections[sectionName] = Section
            return Section
        end
        
        Window.Tabs[tabName] = Tab
        return Tab
    end
    
    return Window
end

--// Retorna Library
return Library
