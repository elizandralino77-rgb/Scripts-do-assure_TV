-- AssureUI Library - Melhorada e Modular
-- Basta colocar como ModuleScript e importar via require()

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local CoreGui = game:GetService("CoreGui")
local TextService = game:GetService("TextService")

local LocalPlayer = Players.LocalPlayer

-- Tema padrão
local Theme = {
    Background = Color3.fromRGB(20,20,20),
    Sidebar = Color3.fromRGB(25,25,25),
    Section = Color3.fromRGB(28,28,28),
    Text = Color3.fromRGB(240,240,240),
    TextDark = Color3.fromRGB(150,150,150),
    Accent = Color3.fromRGB(0,122,204),
    Border = Color3.fromRGB(45,45,45),
    Hover = Color3.fromRGB(35,35,35)
}

local Library = {}
Library.__index = Library
Library.Flags = {}
Library.Notifications = Instance.new("ScreenGui")
Library.Notifications.Name = "AssureNotifications"
Library.Notifications.Parent = CoreGui
Library.Notifications.ZIndexBehavior = Enum.ZIndexBehavior.Global

-- Funções utilitárias
local function createUICorner(parent, radius)
    local uiCorner = Instance.new("UICorner")
    uiCorner.CornerRadius = UDim.new(0, radius or 8)
    uiCorner.Parent = parent
    return uiCorner
end

local function createUIStroke(parent, color, thickness)
    local uiStroke = Instance.new("UIStroke")
    uiStroke.Color = color or Color3.fromRGB(50,50,50)
    uiStroke.Thickness = thickness or 1
    uiStroke.Parent = parent
    return uiStroke
end

local function makeDraggable(topbar, frame)
    local dragging, dragInput, dragStart, startPos
    local function update(input)
        local delta = input.Position - dragStart
        frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset+delta.X, startPos.Y.Scale, startPos.Y.Offset+delta.Y)
    end

    topbar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then dragging = false end
            end)
        end
    end)

    topbar.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then update(input) end
    end)
end

-- Notificação simples
function Library:Notify(title,text,duration)
    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0,250,0,70)
    frame.Position = UDim2.new(1,260,1,-80)
    frame.BackgroundColor3 = Theme.Section
    frame.BorderColor3 = Theme.Border
    frame.BorderSizePixel = 1
    frame.Parent = self.Notifications
    frame.ClipsDescendants = true

    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(1,-20,0,20)
    titleLabel.Position = UDim2.new(0,10,0,5)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = title
    titleLabel.TextColor3 = Theme.Accent
    titleLabel.Font = Enum.Font.Code
    titleLabel.TextSize = 14
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.Parent = frame

    local descLabel = Instance.new("TextLabel")
    descLabel.Size = UDim2.new(1,-20,0,40)
    descLabel.Position = UDim2.new(0,10,0,25)
    descLabel.BackgroundTransparency = 1
    descLabel.Text = text
    descLabel.TextColor3 = Theme.Text
    descLabel.Font = Enum.Font.Gotham
    descLabel.TextSize = 12
    descLabel.TextWrapped = true
    descLabel.TextXAlignment = Enum.TextXAlignment.Left
    descLabel.TextYAlignment = Enum.TextYAlignment.Top
    descLabel.Parent = frame

    local bar = Instance.new("Frame")
    bar.Size = UDim2.new(1,0,0,2)
    bar.Position = UDim2.new(0,0,1,-2)
    bar.BackgroundColor3 = Theme.Accent
    bar.BorderSizePixel = 0
    bar.Parent = frame

    TweenService:Create(frame,TweenInfo.new(0.5),{Position = UDim2.new(1,-260,1,-80)}):Play()
    TweenService:Create(bar,TweenInfo.new(duration or 3,Enum.EasingStyle.Linear),{Size=UDim2.new(0,0,0,2)}):Play()

    task.delay(duration or 3,function()
        local tween = TweenService:Create(frame,TweenInfo.new(0.5),{Position = UDim2.new(1,260,1,-80)})
        tween:Play()
        tween.Completed:Connect(function() frame:Destroy() end)
    end)
end

-- Criar Janela
function Library:CreateWindow(title)
    local Window = {}
    Window.Tabs = {}
    Window.TabButtons = {}

    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "AssureUI"
    screenGui.ResetOnSpawn = false
    screenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

    local mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.Size = UDim2.new(0,550,0,380)
    mainFrame.Position = UDim2.new(0.5,-275,0.5,-190)
    mainFrame.BackgroundColor3 = Theme.Background
    mainFrame.BorderColor3 = Theme.Border
    mainFrame.BorderSizePixel = 1
    mainFrame.Parent = screenGui

    local header = Instance.new("Frame")
    header.Name = "Header"
    header.Size = UDim2.new(1,0,0,35)
    header.BackgroundColor3 = Theme.Sidebar
    header.BorderColor3 = Theme.Border
    header.BorderSizePixel = 1
    header.Parent = mainFrame
    makeDraggable(header,mainFrame)

    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(1,-10,1,0)
    titleLabel.Position = UDim2.new(0,10,0,0)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = title
    titleLabel.TextColor3 = Theme.Accent
    titleLabel.TextSize = 17
    titleLabel.Font = Enum.Font.Code
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.Parent = header

    local closeBtn = Instance.new("TextButton")
    closeBtn.Size = UDim2.new(0,35,1,0)
    closeBtn.Position = UDim2.new(1,-35,0,0)
    closeBtn.BackgroundTransparency = 1
    closeBtn.Text = "X"
    closeBtn.TextColor3 = Theme.TextDark
    closeBtn.Font = Enum.Font.GothamBold
    closeBtn.TextSize = 14
    closeBtn.Parent = header
    closeBtn.MouseButton1Click:Connect(function()
        screenGui:Destroy()
    end)

    local sidebar = Instance.new("ScrollingFrame")
    sidebar.Size = UDim2.new(0,140,1, -36)
    sidebar.Position = UDim2.new(0,0,0,36)
    sidebar.BackgroundColor3 = Theme.Sidebar
    sidebar.BorderColor3 = Theme.Border
    sidebar.BorderSizePixel = 1
    sidebar.ScrollBarThickness = 2
    sidebar.Parent = mainFrame

    local sidebarLayout = Instance.new("UIListLayout")
    sidebarLayout.SortOrder = Enum.SortOrder.LayoutOrder
    sidebarLayout.Parent = sidebar

    local contentArea = Instance.new("Frame")
    contentArea.Size = UDim2.new(1,-142,1,-36)
    contentArea.Position = UDim2.new(0,142,0,36)
    contentArea.BackgroundTransparency = 1
    contentArea.ClipsDescendants = true
    contentArea.Parent = mainFrame

    function Window:AddTab(tabName)
        local tabBtn = Instance.new("TextButton")
        tabBtn.Size = UDim2.new(1,0,0,32)
        tabBtn.BackgroundColor3 = Theme.Sidebar
        tabBtn.Text = tabName
        tabBtn.TextColor3 = Theme.TextDark
        tabBtn.Font = Enum.Font.Gotham
        tabBtn.TextSize = 12
        tabBtn.BorderSizePixel = 0
        tabBtn.Parent = sidebar

        local tabContent = Instance.new("ScrollingFrame")
        tabContent.Size = UDim2.new(1,-4,1,0)
        tabContent.Position = UDim2.new(0,4,0,0)
        tabContent.BackgroundTransparency = 1
        tabContent.BorderSizePixel = 0
        tabContent.Visible = #Window.Tabs == 0
        tabContent.Parent = contentArea

        local listLayout = Instance.new("UIListLayout")
        listLayout.SortOrder = Enum.SortOrder.LayoutOrder
        listLayout.Padding = UDim.new(0,6)
        listLayout.Parent = tabContent

        local tab = {}
        tab.Content = tabContent

        function tab:AddSection(name)
            local section = Instance.new("Frame")
            section.Size = UDim2.new(1,-4,0,30)
            section.BackgroundColor3 = Theme.Section
            section.BorderColor3 = Theme.Border
            section.BorderSizePixel = 1
            section.Parent = tabContent

            local sectionLabel = Instance.new("TextLabel")
            sectionLabel.Size = UDim2.new(1,-10,0,20)
            sectionLabel.Position = UDim2.new(0,5,0,2)
            sectionLabel.BackgroundTransparency = 1
            sectionLabel.Text = name:upper()
            sectionLabel.TextColor3 = Theme.Accent
            sectionLabel.Font = Enum.Font.Code
            sectionLabel.TextSize = 11
            sectionLabel.TextXAlignment = Enum.TextXAlignment.Left
            sectionLabel.Parent = section

            local sectionLayout = Instance.new("UIListLayout")
            sectionLayout.SortOrder = Enum.SortOrder.LayoutOrder
            sectionLayout.Padding = UDim.new(0,4)
            sectionLayout.Parent = section

            return section
        end

        tabBtn.MouseButton1Click:Connect(function()
            for _, t in pairs(Window.Tabs) do t.Content.Visible = false end
            tabContent.Visible = true
        end)

        table.insert(Window.Tabs,tab)
        table.insert(Window.TabButtons,tabBtn)
        return tab
    end

    return Window
end

return Library
